<section class="liquid-glass rounded-3xl px-5 py-8 mb-6">
  <p class="text-[11px] uppercase tracking-[0.28em] text-slate-500">SpendLess Quest</p>
  <h1 class="text-3xl font-semibold tracking-tight mt-2">Coupon hunting, but fun.</h1>
  <p class="text-sm mt-3 text-slate-600 max-w-2xl">Tap a brand, unlock codes, collect XP, and chase today's best savings in a fluid iOS-style browsing experience.</p>
  <div class="mt-4 flex flex-wrap gap-2 text-xs">
    <span class="px-3 py-1 rounded-full liquid-glass">1 tap reveal</span>
    <span class="px-3 py-1 rounded-full liquid-glass">opens offer in new tab</span>
    <span class="px-3 py-1 rounded-full liquid-glass">mobile first</span>
  </div>
</section>

<div class="mb-6 liquid-glass rounded-2xl p-3">
  <label for="brand-search" class="sr-only">Search brands</label>
  <input id="brand-search" type="search" placeholder="Search brands" class="w-full rounded-xl border border-slate-300/60 bg-white/70 py-3 px-4 text-sm" autocomplete="off">
  <p id="brand-search-helper" class="text-xs text-slate-500 mt-2">Showing <span id="brand-visible-count">0</span> brands</p>
</div>

<ul id="brand-grid" class="grid gap-3 sm:grid-cols-2">
  {% assign sorted_brands = site.brands | sort: "title" %}
  {% for brand in sorted_brands %}
    {% assign logo_path = '/media/brand_logos/' | append: brand.brand_slug | append: '.jpg' %}
    <li data-brand-card data-brand-name="{{ brand.title | downcase }}">
      <a href="{{ brand.url | relative_url }}" data-surface-card class="block liquid-glass rounded-2xl px-3 py-3">
        <div class="flex items-start gap-3">
          <div class="w-12 h-12 flex items-center justify-center rounded-xl border border-slate-200 bg-white/80 overflow-hidden">
            <img src="{{ logo_path | relative_url }}" alt="{{ brand.title }} logo" class="w-full h-full object-cover" loading="lazy">
          </div>
          <div class="flex-1">
            <div class="flex items-center justify-between gap-2">
              <span class="font-medium text-sm">{{ brand.title }}</span>
              <span class="text-[11px] text-slate-600">{{ site.coupons | where: "brand_slug", brand.brand_slug | size }} offers</span>
            </div>
            <p class="text-xs text-slate-500 mt-1">Open brand vault â†—</p>
          </div>
        </div>
      </a>
    </li>
  {% endfor %}
</ul>

<div id="brand-empty-state" class="hidden text-center py-12"><p class="text-sm text-slate-500">No brands found.</p></div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const searchInput = document.getElementById('brand-search');
    const cards = Array.from(document.querySelectorAll('[data-brand-card]'));
    const grid = document.getElementById('brand-grid');
    const emptyState = document.getElementById('brand-empty-state');
    const visibleCount = document.getElementById('brand-visible-count');

    function filterBrands() {
      const query = searchInput.value.trim().toLowerCase();
      let matches = 0;
      cards.forEach((card) => {
        const ok = card.dataset.brandName.includes(query);
        card.classList.toggle('hidden', !ok);
        matches += ok ? 1 : 0;
      });
      visibleCount.textContent = matches;
      emptyState.classList.toggle('hidden', matches !== 0);
      grid.classList.toggle('hidden', matches === 0);
    }

    filterBrands();
    searchInput.addEventListener('input', filterBrands);
  });
</script>
