---
layout: default
---

<article class="space-y-6 max-w-2xl">
  <header class="space-y-2">
    <p class="text-xs uppercase tracking-wide text-slate-500">
      <a href="{{ '/brands/' | append: page.brand_slug | append: '/' | relative_url }}" class="hover:text-slate-900">
        {{ page.brand_slug | capitalize }}
      </a>
      · Coupon
    </p>
    <h1 class="text-2xl font-semibold tracking-tight">{{ page.title }}</h1>

    <div class="flex flex-wrap items-center gap-3">
      {% if page.discount_value %}
        <span class="text-xs font-semibold px-2 py-1 rounded-full bg-slate-100 text-slate-800">
          {{ page.discount_value }}
        </span>
      {% endif %}

      {% if page.is_expired %}
        <span class="text-xs font-medium px-2 py-1 rounded-full bg-red-50 text-red-700">
          Expired
        </span>
      {% elsif page.valid_until %}
        <span class="text-xs text-slate-500">
          Valid until {{ page.valid_until }}
        </span>
      {% endif %}
    </div>
  </header>

  {% if page.code %}
    <section class="bg-slate-900 text-slate-50 rounded-xl px-4 py-3 space-y-2" id="coupon-code-card">
      <p class="text-[11px] uppercase tracking-wide text-slate-400">Code</p>

      <button type="button"
              class="hidden-ink w-full text-left border border-slate-700 rounded-lg px-3 py-3"
              data-code="{{ page.code }}"
              aria-label="Reveal and copy coupon code">
        <span class="hidden-ink-overlay" aria-hidden="true"></span>
        <span class="relative inline-block font-mono text-lg hidden-ink-code">{{ page.code }}</span>
        <span class="relative block mt-1 text-xs text-slate-300">Tap to reveal & copy</span>
      </button>

      <p id="copy-status" class="text-xs text-emerald-200 hidden">Copied to clipboard. Opening offer…</p>
    </section>

    <style>
      .hidden-ink {
        position: relative;
        background: radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.08), rgba(15, 23, 42, 0.4) 55%),
                    radial-gradient(circle at 80% 80%, rgba(59, 130, 246, 0.18), rgba(15, 23, 42, 0.35) 60%),
                    #0b1224;
        overflow: hidden;
        isolation: isolate;
      }

      .hidden-ink-overlay {
        position: absolute;
        inset: -8px;
        border-radius: inherit;
        pointer-events: none;
        background:
          radial-gradient(circle at 18% 24%, rgba(255, 255, 255, 0.32), transparent 35%),
          radial-gradient(circle at 72% 18%, rgba(168, 196, 255, 0.26), transparent 30%),
          radial-gradient(120px at 50% 60%, rgba(56, 189, 248, 0.35), transparent 65%),
          linear-gradient(120deg, rgba(255, 255, 255, 0.15), rgba(56, 189, 248, 0.25), rgba(148, 163, 184, 0.2));
        background-size: 180% 180%, 140% 140%, 200% 200%, 160% 160%;
        mix-blend-mode: screen;
        filter: blur(2px);
        opacity: 0.95;
        animation: shimmer 6s ease-in-out infinite alternate, float 14s linear infinite;
        mask-image: var(--ink-mask, none);
        -webkit-mask-image: var(--ink-mask, none);
        mask-repeat: no-repeat;
        -webkit-mask-repeat: no-repeat;
        mask-mode: luminance;
        -webkit-mask-mode: luminance;
        transition: opacity 320ms ease, transform 320ms ease;
      }

      .hidden-ink-overlay::after {
        content: "";
        position: absolute;
        inset: 0;
        background:
          radial-gradient(1px 1px at 10% 20%, rgba(255, 255, 255, 0.7), transparent 60%),
          radial-gradient(1px 1px at 35% 70%, rgba(94, 234, 212, 0.6), transparent 55%),
          radial-gradient(1px 1px at 80% 40%, rgba(255, 255, 255, 0.6), transparent 60%),
          radial-gradient(2px 2px at 50% 50%, rgba(59, 130, 246, 0.4), transparent 65%);
        mix-blend-mode: screen;
        opacity: 0.4;
        animation: twinkle 2s steps(2, end) infinite;
      }

      .hidden-ink-code {
        position: relative;
        color: transparent;
        text-shadow: 0 0 20px rgba(226, 232, 240, 0.95), 0 0 34px rgba(79, 70, 229, 0.55);
        filter: blur(10px);
        letter-spacing: 0.12em;
        transition: filter 320ms ease, text-shadow 320ms ease, color 320ms ease;
      }

      .hidden-ink.revealed .hidden-ink-overlay {
        opacity: 0;
        transform: scale(1.02);
        animation: none;
      }

      .hidden-ink.revealed .hidden-ink-code {
        color: #e2e8f0;
        filter: blur(0);
        text-shadow: none;
      }

      @keyframes shimmer {
        0% { transform: translateX(-8%); }
        100% { transform: translateX(8%); }
      }

      @keyframes float {
        0% { background-position: 0% 0%, 20% 10%, 50% 40%, 30% 30%; }
        100% { background-position: 14% 12%, 0% 20%, 40% 60%, 70% 50%; }
      }

      @keyframes twinkle {
        0%, 100% { opacity: 0.45; }
        50% { opacity: 0.65; }
      }
    </style>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const container = document.getElementById('coupon-code-card');
        const button = container?.querySelector('.hidden-ink');
        const overlay = button?.querySelector('.hidden-ink-overlay');
        const status = document.getElementById('copy-status');

        if (!button) return;

        const code = button.getAttribute('data-code');
        if (!code) return;

        const spots = [];
        const MAX_SPOTS = 18;
        const SPOT_LIFETIME = 1400;
        let rafId = null;

        const updateMask = () => {
          if (!overlay) return;
          const now = performance.now();
          for (let i = spots.length - 1; i >= 0; i -= 1) {
            if (now - spots[i].timestamp > SPOT_LIFETIME) {
              spots.splice(i, 1);
            }
          }

          const gradients = spots.map((spot) => `radial-gradient(110px at ${spot.x}% ${spot.y}%, transparent 0%, transparent 45%, rgba(0, 0, 0, 0.85) 72%, rgba(0, 0, 0, 1) 100%)`);
          const maskValue = gradients.join(', ');

          overlay.style.maskImage = gradients.length ? maskValue : 'none';
          overlay.style.webkitMaskImage = gradients.length ? maskValue : 'none';

          if (gradients.length === 0) {
            rafId = null;
            return;
          }

          rafId = requestAnimationFrame(updateMask);
        };

        const addSpot = (event) => {
          if (!overlay) return;
          const rect = button.getBoundingClientRect();
          const x = ((event.clientX - rect.left) / rect.width) * 100;
          const y = ((event.clientY - rect.top) / rect.height) * 100;

          spots.push({ x, y, timestamp: performance.now() });
          if (spots.length > MAX_SPOTS) {
            spots.shift();
          }

          if (!rafId) {
            rafId = requestAnimationFrame(updateMask);
          }
        };

        const resetInk = () => {
          spots.splice(0, spots.length);
          if (overlay) {
            overlay.style.maskImage = 'none';
            overlay.style.webkitMaskImage = 'none';
          }
          if (rafId) {
            cancelAnimationFrame(rafId);
            rafId = null;
          }
        };

        const openOffer = () => {
          const targetUrl = `https://spendlessnike.wiki/${encodeURIComponent(code)}`;
          window.open(targetUrl, '_blank', 'noopener');
        };

        button.addEventListener('pointerdown', (event) => {
          addSpot(event);
          if (button.setPointerCapture) {
            button.setPointerCapture(event.pointerId);
          }
        });

        button.addEventListener('pointermove', (event) => {
          if (event.pointerType === 'mouse' && event.buttons === 0) return;
          addSpot(event);
        });

        button.addEventListener('pointerleave', resetInk);

        button.addEventListener('click', async () => {
          button.classList.add('revealed');
          resetInk();
          if (status) {
            status.classList.remove('hidden');
            status.textContent = 'Copied to clipboard. Opening offer…';
          }

          try {
            await navigator.clipboard.writeText(code);
          } catch (error) {
            /* Clipboard might be blocked; still proceed to open */
          }

          openOffer();
        });
      });
    </script>
  {% endif %}

  <section class="prose prose-sm max-w-none">
    {{ content }}
  </section>

  {% if page.url_external %}
    <a href="{{ page.url_external }}"
       class="inline-flex items-center text-sm font-medium text-slate-900 border border-slate-300 rounded-full px-4 py-2 hover:bg-slate-100">
      Go to {{ page.brand_slug | capitalize }} site
      <span class="ml-2">↗</span>
    </a>
  {% endif %}
</article>
